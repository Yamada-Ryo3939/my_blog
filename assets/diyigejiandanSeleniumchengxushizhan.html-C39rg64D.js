import{_ as s,c as a,b as e,o as i}from"./app-BCBObj6C.js";const p={};function t(l,n){return i(),a("div",null,[...n[0]||(n[0]=[e(`<h2 id="代码实战" tabindex="-1"><a class="header-anchor" href="#代码实战"><span>代码实战</span></a></h2><p>还是之前的代码，可以自动化的打开Edge浏览器，并且自动化打开必应搜索：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建WebDriver对象，打开Edge浏览器，并自动下载驱动</span></span>
<span class="line">wd <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Edge<span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment"># 调用WebDriver跳转到必应搜索</span></span>
<span class="line">wd<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://cn.bing.com/search/&#39;</span><span class="token punctuation">)</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment"># 程序运行完会自动关闭浏览器，是正常现象</span></span>
<span class="line"><span class="token comment"># 这里加入等待用户输入，防止闪退</span></span>
<span class="line"><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&#39;按回车退出&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 关闭浏览器窗口</span></span>
<span class="line">wd<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码解释" tabindex="-1"><a class="header-anchor" href="#代码解释"><span>代码解释</span></a></h3><p>其中，第4行代码是运行浏览器驱动的</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">wd <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Edge<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>等号右边 返回的是 WebDriver 类型的对象，我们可以通过这个对象来操控浏览器，比如 打开网址、选择界面元素等。<strong>浏览器的名称首字母一定要大写</strong>，否则会出错（因为存在同名的小写文件）</p><p>第7行代码就是使用 WebDriver（也就是wd）中 的 get 方法打开网址</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">wd<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://cn.bing.com/search/&#39;</span><span class="token punctuation">)</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>执行上面这行代码时，自动化程序就发起了 打开网址的 <code>请求消息</code> ，通过浏览器驱动给浏览器。</p><p>浏览器接收到该请求后，就会打开网址，通过浏览器驱动， 告诉自动化程序打开成功。</p><h2 id="常见问题" tabindex="-1"><a class="header-anchor" href="#常见问题"><span>常见问题</span></a></h2><p>缺省情况下Webdriver被启动之后会在终端上输出很多日志信息，比如：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">DevTools listening on ws://127.0.0.1:52496/devtools/browser/be6b2505-bc92-4a33-a22d-0b222fef250a</span>
<span class="line"><span class="token punctuation">[</span><span class="token number">16440</span>:4804:1222/221218.314:ERROR:chrome<span class="token punctuation">\\</span>browser<span class="token punctuation">\\</span>task_manager<span class="token punctuation">\\</span>providers<span class="token punctuation">\\</span>fallback_task_provider.cc:126<span class="token punctuation">]</span> Every renderer should have at least one task provided by a primary task provider. If a <span class="token string">&quot;Renderer&quot;</span> fallback task is shown, it is a bug. If you have repro steps, please <span class="token function">file</span> a new bug and tag it as a dependency of crbug.com/739782.</span>
<span class="line"><span class="token punctuation">[</span><span class="token number">16440</span>:4804:1222/221218.532:ERROR:chrome<span class="token punctuation">\\</span>browser<span class="token punctuation">\\</span>task_manager<span class="token punctuation">\\</span>providers<span class="token punctuation">\\</span>fallback_task_provider.cc:126<span class="token punctuation">]</span> Every renderer should have at least one task provided by a primary task provider. If a <span class="token string">&quot;Renderer&quot;</span> fallback task is shown, it is a bug. If you have repro steps, please <span class="token function">file</span> a new bug and tag it as a dependency of crbug.com/739782.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="关闭日志" tabindex="-1"><a class="header-anchor" href="#关闭日志"><span>关闭日志</span></a></h3><p>可以加入如下代码：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver</span>
<span class="line"> </span>
<span class="line"><span class="token comment"># 加上参数，禁止 chromedriver 日志写屏</span></span>
<span class="line">options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&#39;excludeSwitches&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;enable-logging&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment"># 这里指定 options 参数</span></span>
<span class="line">wd <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Edge<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="浏览器首页显示防病毒重置设置" tabindex="-1"><a class="header-anchor" href="#浏览器首页显示防病毒重置设置"><span>浏览器首页显示防病毒重置设置</span></a></h3><p>有时候Selenium自动化时，浏览器会弹出**“Windows Defender防病毒要重置您的设置”**的弹窗，解决方法如下：</p><ol><li>命令行输入 <code>regedit</code> ，运行注册表编辑器</li><li>在左边的目录树找到 <code>HKEY_CURRENT_USER\\Software\\Google\\Chrome</code></li><li>删除其下的 <code>TriggeredReset</code> 子项</li><li>关闭 注册表编辑器</li></ol>`,20)])])}const o=s(p,[["render",t]]),r=JSON.parse('{"path":"/blogs/Selenium/diyigejiandanSeleniumchengxushizhan.html","title":"Part 2.第一个简单Selenium程序实战和问题解决","lang":"en-US","frontmatter":{"title":"Part 2.第一个简单Selenium程序实战和问题解决","date":"2025/9/22","tags":["Selenium自动化"],"categories":["技术学习"]},"headers":[{"level":2,"title":"代码实战","slug":"代码实战","link":"#代码实战","children":[{"level":3,"title":"代码解释","slug":"代码解释","link":"#代码解释","children":[]}]},{"level":2,"title":"常见问题","slug":"常见问题","link":"#常见问题","children":[{"level":3,"title":"关闭日志","slug":"关闭日志","link":"#关闭日志","children":[]},{"level":3,"title":"浏览器首页显示防病毒重置设置","slug":"浏览器首页显示防病毒重置设置","link":"#浏览器首页显示防病毒重置设置","children":[]}]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"filePathRelative":"blogs/Selenium/第一个简单Selenium程序实战.md"}');export{o as comp,r as data};
